\documentclass[12pt]{report}

\usepackage[dutch]{babel}
\usepackage[nobottomtitles]{titlesec}
\usepackage[bottom]{footmisc}
\usepackage{graphicx}
\usepackage{titleps}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{verbatim}
\usepackage{titling}
\usepackage[toc,page]{appendix}
\usepackage{bm}

\usepackage{fancyhdr}

\pagestyle{fancy}

\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\sectionmark}[1]{\markright{#1}}
\fancyhf{}
\fancypagestyle{plain}{%
  \fancyhf{}%
	\rfoot{\fancyplain{}{\nouppercase{\thepage}}}
	\lfoot{\fancyplain{}{Thorvald Dox}}
  \renewcommand{\headrulewidth}{0pt}% Line at the header invisible
  \renewcommand{\footrulewidth}{0.4pt}% Line at the footer visible
}
\lhead{\fancyplain{}{Semilineaire MESMA}}
\rhead{\fancyplain{}{\nouppercase{\leftmark}}}
\rfoot{\fancyplain{}{\nouppercase{\thepage}}}
\lfoot{\fancyplain{}{Thorvald Dox}}
\renewcommand{\footrulewidth}{0.4pt}

\fancyhfoffset[E,O]{0pt}
\date{}
  
\usepackage[margin=1in]{geometry}
\usepackage{float}



\usepackage[super,sort]{natbib}
\usepackage{bibentry}
\nobibliography*

\newcommand{\footcite}[1]{\cite{#1}\let\thefootnote\relax \footnote{\cite{#1} \bibentry{#1}} }

\DeclareMathOperator*{\Odot}{\bigodot}
\allowdisplaybreaks

%\title{Semi-lineair Multiple Endmember mixture spectrum analysis}
\title{Semilineaire spectraalanalyse met meerdere eindmembers}
\author{Thorvald Dox}

\begin{document}
\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE Universiteit Antwerpen}\\[1.5cm] % Name of your university/college
\textsc{\Large Fysica}\\[0.5cm] % Major heading such as course name
\textsc{\large Masterproef}\\[0.5cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \Large \bfseries \thetitle}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \large
\emph{Auteur:}\\
\theauthor % Your name
~\\
~\\
~\\
\end{flushleft}
\end{minipage}
~
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Promotor:} \\
Paul {Scheunders} \\ % Supervisor's Name
\emph{Copromotor:} \\
Rob {Heylen} % Supervisor's Name
\end{flushright}
\end{minipage}\\[5cm]

% If you don't want a supervisor, uncomment the two lines below and remove the section above
%\Large \emph{Author:}\\
%John \textsc{Smith}\\[3cm] % Your name

%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------

%{\large \today}\\[3cm] % Date, change the \today to a set date if you want to be precise

%----------------------------------------------------------------------------------------
%	LOGO SECTION
%----------------------------------------------------------------------------------------

%\includegraphics[height=4cm]{remote.png}
\includegraphics[height=4cm]{download.jpg}
\hspace{5 cm}
\includegraphics[height=4cm]{vlabsym.png}
 \\[1cm] % Include a department/university logo - this will require the graphicx package

 
%----------------------------------------------------------------------------------------

\vfill % Fill the rest of the page with whitespace

\end{titlepage}
\tableofcontents
\newpage
\chapter*{Abstract}
\addcontentsline{toc}{chapter}{Abstract}

\newpage
\chapter*{Inleiding}
\addcontentsline{toc}{chapter}{Inleiding}


Aardopservatie is de studie van het extraheren en catalogiseren van objecten of materialen op het aardoppervlak. Dit gebeurt door middel van hyperspectrale satelietbeelden. De meest voor de hand liggende toepassing hiervan is cartografie, wat letterlijk het in kaart brengen van het aardoppervlak inhoud, maar dit kan ook gebruikt worden in biologische en militaire toepassingen. Een voorbeeld hiervan is het in kaart brengen van verschillende vegetatievormen\cite{dias12} om op deze manier invasieve soorten planten op te sporen. 

Gewone beelden van een camera bevatten drie kleuren. Dit betekend dat voor elke pixel, een afbeelding drie waarden heeft, namelijk de hoeveelheid rood, groen en blauw in deze pixel. Hyperspectrale cameras werken in essentie op dezelfde manier, alleen detecteerd deze camera niet alleen de hoeveelheid rood, groen en blauw, maar detecteert deze een groot aantal banden. Doordat deze banden meer informatie bevatten dan de banden van een gewone camera, kan hier  meer informatie uit gehaald worden. Deze informatie, het zogenaamde spectra, is uniek voor elk materiaal. Daardoor kan uit dit spectrum het aanwezige materiaal bepaald worden.

Het doel van spectrale anaylise is om uit deze hyperspectrale beelden het bepalen welke materialen zich op een specifieke pixel bevinden. Hoewel het belangrijkste toepassing hiervan de aardopservatie is, kan dit evidenterwijs ook gebruikt worden om materialen te analyseren in een laboratorium of voor bijvoorbeeld kwaliteitscontrole in de industrie.


Een pixel in een hyperspectraal beeld bevat meerdere materialen. Een van de belangrijkste oorzaken is het gevolg van de beperkte resolutie van de camera. Maar zelfs als het praktisch haalbaar was om de resolutie kleiner te maken, ligt het probleem vooral in de fractalische eigenschappen van veel objecten. Neem nu bijvoorbeeld een bos. Als we een zeer grove resolutie gebruiken, vallen er verschillende soorten bomen in een enkele pixel. Als de pixels kleiner worden, kunnen bomen al van elkaar onderscheiden worden, maar de takken van verschillende bomen nog niet. Zelfs als we enkel een blad beschouwen zijn er nog verschillende materialen, aangezien de nerven van het blad een ander materiaal hebben dan de bladmoes. Een ander voorbeeld zijn mineralen. Een gesteente bevat verschillende mineralen, maar om deze van elkaar te kunnen onderscheiden moet de pixelgrootte al op microscopisch niveau zijn. 

Hierom is het van belang om een spectra van een pixel, dat een combinatie is van de spectra van de verschillende materialen in deze pixel, te kunnen ``ontmengen''.


\chapter{ontmengen}



\section{spectrale analyse}


Het spectra van licht kan beschreven worden als een wiskunde functie die een frequentie omzet in een intensiteit. In werkelijkheid bevat een hyperspectraal beeld niet de volledige functie, maar bevat deze tweehonderd waarden in deze functie, de zogenoemde banden. Dit matlab\citep{MATLAB} zal dit worden opgeslagen als een driedimensinale tensor, waarbij de verschillende assen de x positie, y positie en band van de pixel weergeven. In deze thesis zijn we niet geintereseerd in  interpixel-interacties, wat betekend dat het materiaal in een pixel geen invloed heeft op het spectrum van andere pixels. Daardoor kan de drie-dimentionale matrix worden omgezet in een matrix, waar de rijen de verschillende pixels zijn en de colommen de de banden.  

De spectra in deze hyperspectrale beelden moeten vergeleken worden met de spectra van de materialen, de zogenaamde endmembers. Hiervoor moet er eerst gekend zijn op welke manier de endmembers mengen. De meest voor de hand liggende methode is de linaire methode, waar het spectrum van elke endmember wordt vermenigvuldigd met de abundantie, en dan worden alle spectra opgeteld. Hierbij is de abundantie een getal dat het gedeelte van de lichtstralen dat afkomstig is van dat materiaal weergeeft. Aangezien dit een goede maat is voor de aanwezige hoeveelheid van een bepaald materiaal in een pixel, is dit de belangrijkste parameter waarin we ge\"intereseerd zijn.

%\begin{itemize}
%\item spectra als functies (eigenschappen van licht)
%\item spectra als vector (endmembers) $\rightarrow$ matlab implementatie
%\item mengen van endmembers (abundancies)
%\end{itemize}

\subsection{reflectie}

Wanneer een lichtstraal invalt op een materiaal reflecteert deze een gedeelte van dit licht. Het nieuwe spectrum van het gereflecteerde licht kan bepaald worden aan de hand van de eigenschappen van het materiaal en het spectrum van het binnenkomende licht. Er kan de benadering gemaakt worden dat de intensiteit voor een gegeven frequentie van het gereflecteerde spectrum alleen afhankelijk is van de intensiteit van het invallende spectrum, en deze daar recht evenredig aan is. In dit geval kan de reflectie beschreven worden als een Hadamard van het spectrum van de inkomende straal en het ``spectrum'' van het materiaal. Dit spectrum is nu geen vector van intensiteiten weer, maar een vector die voor elke frequentie bevat welk deel van de inkomende lichtstraal wordt gereflecteerd. 

\subsection{atmosferische correctie}

Wanneer de lichtbron die we beschouwen uniform and genormaliseerd is, is het spectrum van het materiaal gelijk aan het spectrum van het gedetecteerde licht. Alleen is de in werkelijkheid gebruikte lichtbron -meestal is dit de zon- niet uniform. Ook reist de lichtstraal niet onveranderd door de atmosfeer. Er zijn verschillende effecten zoals verschuiving en  verstrooiing die het spectrum be\"invloeden. De gebruikte datasets in deze thesis zijn al door een algoritme gecorrigeerd voor deze effecten, en we kunnen deze dus beschouwen als verlicht door een uniforme lichtbron.

\section{ontmengen}

Bij het ontmengen gaat het erom dat de juiste abundanties en endmembers gevonden worden zodat als deze gemengd worden volgens ons bovengenoemde mixing model, men als uiteindelijk spectrum terug het gemeten spectrum krijgt. In dit hoofdstuk beperken we ons tot de abundaties, het bepalen van de endmembers wordt beschreven in hoofdstuk \ref{sec:select}.

Echter, omdat het mixing model slechts een benadering is van de werkelijkheid en omdat op een experimentele meting altijd een vorm van ruis zit, kan het exacte spectrum nooit terug gevonden worden. Er wordt daarom gezocht naar het reconstructiespectrum dat het meeste lijkt op het werkelijke spectrum. De ruis was verondersteld normaal verdeeld ofwel Gaussisch verdeeld te zijn, wat meestal het geval is in de meeste takken van de fysica. Dit is een eenvoudig geval van het centrale-limiet theorema, dat zegt dat de som van een groot aantal kansvariabelen normaal verdeeld is. 

Noem $\bm{x}$ het gemeten spectrum, en $\bm{y}$ het reconstructiespectrum, met $\bm{\eta}$ de ruis, dan is

\begin{equation}\label{eq:rec}
\bm{x} = \bm{y} + \bm{\eta}
\end{equation}

De kans dat $\bm{x}$ gemeten wordt, gegeven dat $\bm{y}$ het werkelijk gemeten spectrum is, is $f(\eta)$, waarbij $f$ de normale verdeling is. Aangezien de normale verdeling alleen afhankelijk is van de kwadratische norm, zijn we ook alleen ge\"intereseerd in de kwadratische norm van de ruis. De normale verdeling is ook groter wanneer deze kwadratische norm kleiner is, dus moet om de kans te maximaliseren de norm van de ruis geminimaliseerd worden. 

Deze norm kan berekend worden gebruik makend van vergelijking \ref{eq:rec}.

\begin{eqnarray}
\left|\bm{\eta}\right| &= \left|\bm{x} - \bm{y}\right|
\end{eqnarray}

De uitdrukking $\left|\bm{x} - \bm{y}\right|$ noemt men de reconstructieerror. Het is deze uitdrukking dat geminimaliseerd moet worden.

Het minimaliseren van een uitdrukking om een waarde te vinden noemt men een optimalisatieprobleem, omdat men op zoek is naar de optimale waarden voor de verschillende parameters.

\subsection{vrijheidsgraden}

In een optimalisatieprobleem noemt men het aantal re\"eele continue variabelen waarvan een variable afhank de vrijheidsgraden. Wanneer het aantal te bepalen vrijheidsgraden groter is dan het aantal gegeven vrijheidsgraden, dan is het probleem ondergedefini\"eerd. Dit houd in dat er meerdere mogelijke oplossingen voor de vrije parameters zijn waarvoor alle voorwaarden voldaan zijn. Als dit voorkomt, is een gevonden oplossing niet met zekerheid de juiste oplossing, en geeft het model dus verkeerde oplossingen terug, die lijken te voldoen aan het systeem.

Het aantal vrijheidsgraden van het gemeten spectrum is per definitie $200$, aangezien dit een vector is van tweehonderd re\"eele waarden. Maar uit dimensionale analyse volgt dat het werkelijke aantal vrijheidsgraden maar rond de $15$ ligt. Als er dus een model gebruikt wordt met meer dan $15$ parameters geeft dit per definitie een goed resultaat, zelfs als dit model totaal niet overeenkomt met de werkelijkheid. Wanneer verschillende modellen vergelijken worden, zal een model met meer vrijheidsgraden een lagere recontructie-error hebben.  

\section{lineair ontmengen}




\subsubsection{niet-negativiteit}

\subsubsection{sum to one}



\subsection{implementatie in matlab}

\section{multilineair ontmengen}

Uitleg $\rightarrow$ lichtstraal heeft kans om te reflecteren

\subsection{berekening}

\subsection{reflectancy vs albedo}

\subsection{afhankelijke vs onafhankelijke P waarden}

\subsection{Ondergrens van P waarde}

Of dat $P > 0$ moet gebruikt worden als voorwaarde of niet.

\subsection{implementatie in matlab}

\chapter{Selecteren} \label{sec:select}

\section{Variabiliteit}

\begin{itemize}
\item variabiliteit
\item bibliotheek $\rightarrow$ model
\item pixel-afhankelijke selectie
\end{itemize}

\section{MESMA}

\begin{itemize}
\item Ontmengen aan de hand van elke subset
\item Selectie op basis van niet-negativiteitsvoorwaarde
\end{itemize}

\subsection{ontmengingsmethode naar keuz (lineair vs multilineair)}

\subsection{implementatie in matlab}

\section{AAM}

\begin{itemize}
\item concept hoek in hoogdimentonale ruimtes
\item AAM
\end{itemize}

\subsection{implementatie in matlab}


\chapter{Methodes}

\section{Semi-lineair model}

ontkoppeling van Ontmenging in MESMA bij selectie tov ontmenging voor abundancies

\subsection{Theoretische controle dmv monte carlo simulaties}

\section{multilineair AAM}

\chapter{experimentele vergelijking van verschillende methodes}

\section{looptijd en reconstructie-error}

\section{Alina dataset}

\section{Lijst en korte uitleg bij alle methodes}

Elke methode is hiervoor beschreven, maar dit beschrijft kort de verschillen in de methodes en hoe deze geimplementeerd zijn door middel van `schakelaars' in de code. Ook een uitleg bij de weergave van de resultaten. 

\begin{itemize}
\item lineair MESMA
\item semi-lineair MESMA
\item multi-lineair MESMA
\item lineair AAM
\item multilineair AAM
\end{itemize}

$\rightarrow$ Voor de multilineaire modellen wordt ook al dan niet $P> 0$ en $P$ materiaalafhankelijk vergeleken.



\section{Bepreking lineair vs semi-linair}

Verschil voor hoge reflectie (bomen)
$\rightarrow$ semilinair geeft betere resultaten voor dezelfde runtime

\section{Bespreking semi-lineair vs multilineair}

$\rightarrow$ semilineair geeft vergelijkbare resultaten op kortere tijd

\section{Bespreking P-afhankelijkheid}

$\rightarrow$ P-afhankelijkheid geeft vergelijkbare resultaten op gelijke tijd, maar heeft meer vrijheidsgraden

\section{Bespreking P-ondergrens}

verschil voor lage reflectie (asfalt)
$\rightarrow$ Weglaten van ondergrens geeft betere resultaten op gelijke tijd.

\section{Bepreking multilinair AAM vs semilinair model}

$\rightarrow$ zelfde resultaten voor kortere tijd.

\begin{appendices}


\end{appendices}


\begin{flushleft}
\nocite{*}
\bibliography{biblio}{}
\bibliographystyle{amsplain}
\addcontentsline{toc}{chapter}{Bibliografie}

\end{flushleft}


\end{document}
